# Pre-Audit Inventory (Project State Catalog)

This document serves as a comprehensive "briefing document" capturing the application's state as of this audit. It is based on a direct review of the source code, not on past conversation history.

| Feature Name | Status | Code Evidence | File Path | Explanation |
| :--- | :--- | :--- | :--- | :--- |
| **Core Story Parsing** | âœ… Done | `export async function getParsedStory(storyText: string): Promise<{...}> { ... await parseDialogueFlow({ storyText }); ... }` | `src/lib/actions.ts` | The `getParsedStory` server action exists and correctly calls the `parseDialogueFlow` to process the story text. |
| **Character Portrait Generation** | âœ… Done | `export async function getCharacterPortraits(characters: Character[]): Promise<CharacterPortrait[]> { ... await generateCharacterPortraitsFlow({ characters }); ... }` | `src/lib/actions.ts` | The `getCharacterPortraits` action calls the `generateCharacterPortraitsFlow`, which uses an image generation model. |
| **Multi-Voice Audio Generation** | âœ… Done | `const {media, transcript: ttsTranscript} = await ai.generate({ model: 'googleai/gemini-2.5-flash-preview-tts', ... prompt: ssmlString });` | `src/ai/flows/generate-multi-voice-tts.ts` | The flow uses SSML and calls the `gemini-2.5-flash-preview-tts` model to generate a single audio file for the whole scene. |
| **Synchronized "Karaoke" Highlighting** | âœ… Done | `const newCurrentIndex = transcript.findIndex(t => currentTime >= t.startTime && currentTime < t.endTime);` | `src/components/vivid-voice/StoryDisplay.tsx` | The `StoryDisplay` component uses the detailed transcript from the TTS flow to find and highlight the active segment during audio playback. |
| **AI-Powered Sound Design** | ðŸŸ¡ Partially Implemented / Mocked | `const matchedKey = Object.keys(soundLibrary).find(key => lowerQuery.includes(key)); return { ...effect, soundUrl: matchedKey ? soundLibrary[matchedKey] : defaultSound, }` | `src/lib/actions.ts` | The `getSoundDesign` action correctly calls an AI flow to get a *query* (e.g., "door creak"), but then maps it to a small, hard-coded `soundLibrary` object. It does not call a real sound API. |
| **User Accounts & Login** | âœ… Done | `import { onAuthStateChanged, User, GoogleAuthProvider, signInWithPopup, signOut } from 'firebase/auth';` | `src/contexts/AuthContext.tsx` | The `AuthContext` uses Firebase Authentication for Google Sign-In, and the Header component correctly displays user state. |
| **Story Saving & Dashboard** | âœ… Done | `export async function getStoriesForUser(userId: string): Promise<Story[]> { ... const q = query(storiesCollection, where('userId', '==', userId)); ... }` | `src/lib/data.ts` | The `data.ts` file contains functions to save stories to Firestore and fetch them for a specific user. The `dashboard/page.tsx` component displays them. |
| **Literary Device Scanner** | âœ… Done | `export function LiteraryAnalysisTab({ storyText }: { storyText: string }) { ... const result = await analyzeLiteraryDevices(storyText); ... }` | `src/components/vivid-voice/LiteraryAnalysis.tsx` | The component exists and calls the `analyzeLiteraryDevices` server action. The corresponding AI flow is also implemented. |
| **Dialogue Dynamics Analyzer** | âœ… Done | `export function DialogueDynamicsAnalysis({ storyText }: { storyText: string }) { ... const result = await analyzeDialogueDynamics(storyText); ... }` | `src/components/vivid-voice/DialogueDynamicsAnalysis.tsx` | The component exists and calls the `analyzeDialogueDynamics` server action. It correctly renders Recharts components with the results. |
| **Pacing Visualizer** | âœ… Done | `export function PacingAnalysis({ storyText }: { storyText: string }) { ... const result = await analyzeStoryPacing(storyText); ... }` | `src/components/vivid-voice/PacingAnalysis.tsx` | The component exists and calls the `analyzeStoryPacing` server action. It renders an AreaChart with the narration vs. dialogue data. |
| **Trope Inverter** | âœ… Done | `export function TropeInverter({ storyText }: { storyText: string }) { ... const result = await invertTropes(storyText); ... }` | `src/components/vivid-voice/TropeInverter.tsx` | The component exists and calls the `invertTropes` server action. The corresponding AI flow is also implemented. |
| **AI Actor's Studio** | âœ… Done | `export function ActorStudio({ characters, storyText }: ActorStudioProps) { ... const response = await getCharacterResponse(...); ... }` | `src/components/vivid-voice/ActorStudio.tsx` | The interactive chat component exists and calls the `getCharacterResponse` action to simulate a conversation with a character. |
| **Unreliable Narrator Mode** | âœ… Done | `export function UnreliableNarrator({ storyText }: { storyText: string }) { ... const result = await getBiasedStory(storyText, selectedBias); ... }` | `src/components/vivid-voice/UnreliableNarrator.tsx` | The component exists and calls the `getBiasedStory` action to get a rewritten narrative based on a selected bias. |
| **"Show, Don't Tell" Converter** | âœ… Done | `export function ShowDontTell({ storyText, onApplySuggestion }: ShowDontTellProps) { ... const result = await getShowDontTellSuggestions(storyText); ... }` | `src/components/vivid-voice/ShowDontTell.tsx` | The component exists and calls the `getShowDontTellSuggestions` action. It also features an "Apply" button to modify the editor state. |
| **Consistency Guardian** | âœ… Done | `export function ConsistencyGuardian({ storyText }: { storyText: string }) { ... const result = await findInconsistencies(storyText); ... }` | `src/components/vivid-voice/ConsistencyGuardian.tsx` | The component exists and calls the `findInconsistencies` server action. The corresponding AI flow is also implemented. |
| **Subtext Analyzer** | âœ… Done | `export function SubtextAnalyzer({ storyText }: { storyText: string }) { ... const result = await analyzeSubtext(storyText); ... }` | `src/components/vivid-voice/SubtextAnalyzer.tsx` | The component exists and calls the `analyzeSubtext` server action. The corresponding AI flow is also implemented. |
| **Perspective Shifter** | âœ… Done | `export function PerspectiveShifter({ characters, storyText }: PerspectiveShifterProps) { ... const analysisResult = await shiftPerspective(...); ... }` | `src/components/vivid-voice/PerspectiveShifter.tsx` | The component exists and calls the `shiftPerspective` server action. The corresponding AI flow is also implemented. |
| **Firestore Security Rules** | âœ… Done | `match /stories/{storyId} { allow read, write: if request.auth != null && request.auth.uid == resource.data.userId; }` | `firestore.rules` | The `firestore.rules` file exists and contains rules to ensure users can only access their own documents. |
| **Comprehensive Test Coverage** | âœ… Done | `import { ConsistencyGuardian } from './ConsistencyGuardian'; ... it('should render the button and handle successful analysis', ...` | `src/components/vivid-voice/ConsistencyGuardian.test.tsx` | Test files exist for all major components, server actions, and utility functions, including the analysis tools. |
